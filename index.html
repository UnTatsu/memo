<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ã¡ã‚‡ã£ã¨ã—ãŸãƒ¡ãƒ¢</title>
<script src="js/jquery-2.1.3.min.js"></script>
<link rel="stylesheet" href="css/sample.css">
</head>
<body>
<header>
  <div class="bg_pattern Lines">
    <h1>ğŸ“ MEMO ğŸ“„</h1>
    <div class="mainCont">
      <!-- ãƒ¡ãƒ¢ -->
      <div class="memo">
          <input type="text" id="key" placeholder="ã‚¿ã‚¤ãƒˆãƒ«">
          <textarea id="memo" placeholder="å†…å®¹"></textarea>
          <ul>
              <li id="save">ä¿å­˜</li>
              <li id="clear">ã‚¯ãƒªã‚¢</li>
          </ul>
      </div>
  
  
      <!-- é›»å“ -->
      <div class="calculator">
          <input readonly id="display" type="text" value="0">
          <div class="commands">
            <button class="command ac" onclick="c_click()">C</button>
            <button class="command operator squared" onclick="ope_click('^')">^</button>
            <button class="command operator root" onclick="num_click('^0.5')">âˆš</button>
            <button class="command operator division" onclick="ope_click(this.innerHTML)">Ã·</button>
            <button class="command number" onclick="num_click(this.innerHTML)">7</button>
            <button class="command number" onclick="num_click(this.innerHTML)">8</button>
            <button class="command number" onclick="num_click(this.innerHTML)">9</button>
            <button class="command operator multi" onclick="ope_click(this.innerHTML)">Ã—</button>
            <button class="command number" onclick="num_click(this.innerHTML)">4</button>
            <button class="command number" onclick="num_click(this.innerHTML)">5</button>
            <button class="command number" onclick="num_click(this.innerHTML)">6</button>
            <button class="command operator sub" onclick="ope_click(this.innerHTML)">-</button>
            <button class="command number" onclick="num_click(this.innerHTML)">1</button>
            <button class="command number" onclick="num_click(this.innerHTML)">2</button>
            <button class="command number" onclick="num_click(this.innerHTML)">3</button>
            <button class="command operator add" onclick="ope_click(this.innerHTML)">+</button>
            <button class="command number-2col" onclick="num_click(this.innerHTML)">0</button>
            <button class="command dot" onclick="num_click(this.innerHTML)">.</button>
            <button class="command equal" onclick="equal_click()">ï¼</button>
          </div>
        </div>

    </div>
  </div>


</header>
<main>

</main>
<table id="list">
<!-- ã“ã“ã«è¿½åŠ ãƒ‡ãƒ¼ã‚¿ãŒæŒ¿å…¥ã•ã‚Œã‚‹ -->
</table>
<script>

//1.Save ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
$("#save").on("click",function(){
    const key = $("#key").val();
    const value = $("#memo").val();
    localStorage.setItem(key,value);
    const html = '<tr><th>'+key+'</th><td>'+value+'</td><td><button class="revise">ä¿®æ­£</button></td><td><button class="delite">å‰Šé™¤</button></td></tr>';
    $("#list").append(html);
});

//2.clear ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
$("#clear").on("click",function(){
    let key = document.getElementById('key').value = "";
    let value = document.getElementById('memo').value = "";
});

//3.ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ï¼šä¿å­˜ãƒ‡ãƒ¼ã‚¿å–å¾—è¡¨ç¤º
for(let i=0; i<localStorage.length; i++){
    const key   = localStorage.key(i);
    const value = localStorage.getItem(key);
    const html = '<tr><th>'+key+'</th><td>'+value+'</td><td><button class="revise">ä¿®æ­£</button></td><td><button class="delite">å‰Šé™¤</button></td></tr>';
    $("#list").append(html);
}

//4.ä¿®æ­£ ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
$(".revise").on("click",function(){
    let key =  document.getElementById('key').value = $(this).closest('tr').children('th').eq(0).text(); //é¸æŠã—ãŸè¡Œã®keyå–å¾—ï¼†è¡¨ç¤º
    let value =  document.getElementById('memo').value = $(this).closest('tr').children('td').eq(0).text(); //é¸æŠã—ãŸè¡Œã®valueå–å¾—ï¼†è¡¨ç¤º
})

//5.å‰Šé™¤ ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
$(".delite").on("click",function(){
    let key = $(this).closest('tr').children('th').eq(0).text(); //é¸æŠã—ãŸè¡Œã®keyå–å¾—ï¼†è¡¨ç¤º
    let value = $(this).closest('tr').children('td').eq(0).text(); //é¸æŠã—ãŸè¡Œã®valueå–å¾—ï¼†è¡¨ç¤º
    localStorage.removeItem(key);
    location.reload();
})

//6.é›»å“è¨ˆç®—
let result = "";
let is_calc = false; //è¨ˆç®—çŠ¶æ³åˆ¤å®šç”¨ falseâ†’æœªè¨ˆç®—çŠ¶æ…‹

window.onload = function(){ //èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
  result = document.getElementById('display'); //displayã«resultã‚’åæ˜ 
} 

function c_click(){ //ã‚¯ãƒªã‚¢ãƒ¼
  result.value = "0"; 
  is_calc = false;
}

function num_click(val){ //æ•°å­—ã‚¯ãƒªãƒƒã‚¯æ™‚ã®æŒ™å‹•
  if(is_calc)  result.value = "0"; //è¨ˆç®—æ¸ˆã®å ´åˆåˆæœŸåŒ–
  is_calc = false;  

  if(result.value =="0" && val == "0"){ //åˆæœŸã«ï¼å…¥åŠ›
    result.value = "0";
  }else if(result.value == "0" && val == "."){ //åˆæœŸã«.å…¥åŠ›
    result.value = "0.";
  }else if(result.value == "0"){ //åˆæœŸã«ãã®ä»–æ•°å­—å…¥åŠ›
    result.value = val;
  }else{ //ãã‚Œä»¥å¤–ã§ã¯æ•°å­—è¿½åŠ 
    result.value += val;
  }
}

function ope_click(val){ //æ¼”ç®—å­ã‚¯ãƒªãƒƒã‚¯æ™‚ã®æŒ™å‹•
  if(is_calc)  is_calc = false;
  
  if(is_ope_last()){
    result.value = result.value.slice(0, -1) + val; //æ¼”ç®—å­ãŒé‡ãªã‚‹å ´åˆã¯æ›¸ãæ›ãˆ
  } else {
    result.value += val; //æ¼”ç®—å­è¿½åŠ 
  }
}

function equal_click(){
  if(is_ope_last())  result.value = result.value.slice(0, -1); //æœ€å¾ŒãŒæ¼”ç®—å­ã®å ´åˆã«é™¤å»

  let memo_cal =document.getElementById('memo') ;
  memo_cal.value = result.value; //è¨ˆç®—å¼ã‚’memoã«è¡¨ç¤º

  let temp = new Function("return " + result.value.replaceAll("Ã—", "*").replaceAll("Ã·", "/").replaceAll("^", "**"))(); //è¨ˆç®—ç”¨ã®æ¼”ç®—å­ã«ç½®æ›
  if(temp == Infinity || Number.isNaN(temp)){
    result.value = "Error"; //ç„¡é™å¤§ã‹è¨ˆç®—ä¸å¯æ™‚ã«ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
  }else{
    result.value = temp.toLocaleString(); //3æ¡åŒºåˆ‡ã‚Šã§è¡¨ç¤º
    let key_cal =document.getElementById('key') ;
    key_cal.value = result.value; //è¨ˆç®—çµæœã‚’keyã«è¡¨ç¤º
    is_calc = true; //è¨ˆç®—æ¸ˆãƒ•ãƒ©ã‚°
  }

}

function is_ope_last(){ //æœ«å°¾ã®æ¼”ç®—å­åˆ¤å®š
  return ["+","-","Ã—","Ã·","^"].includes(result.value.toString().slice(-1));
}



</script>
<footer><small>babybeat22</small></footer>
</body>
</html>